<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://kougazhang.github.io/cdn-docs/cloud/image/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

        <title>又拍云文档中心</title>

        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../css/prettify.css" rel="stylesheet">
        <link href="../../css/main.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="navbar navbar-upyun" role="navigation">
    <div class="container clearfix">
        <div class="navbar-header">
            <a class="navbar-brand" href="https://www.upyun.com/">又拍云文档中心</a>
        </div>

        <div class="navbar-collapse collapse pull-right">
            <ul class="nav navbar-nav">
            
              <li class="pull-left">
                
                <a href="">文档首页</a>
                
              </li>
            
              <li class="pull-left">
                
                <a href="cdn/">CDN</a>
                
              </li>
            
              <li class="pull-left">
                
                <a href="live/Introduction/">直播</a>
                
              </li>
            
              <li class="pull-left">
                
                <a href="video/">点播&短视频</a>
                
              </li>
            
              <li class="pull-left">
                
                <a href="api/">云存储</a>
                
              </li>
            
              <li class="pull-left active">
                
                <a href="cloud/">云处理</a>
                
              </li>
            
              <li class="pull-left">
                
                <a href="ai/audit/">人工智能</a>
                
              </li>
            
              <li class="pull-left">
                
                <a href="download/">SDK&工具</a>
                
              </li>
            
              <li class="pull-left">
                
                <a href="faq/">常见问题</a>
                
              </li>
            
                <li>
                    <a href="https://segmentfault.com/upyun" target="_blank">技术问答</a>
                </li>
            </ul>

            <ul class="list-unstyled navbar-right clearfix">
                <li class="login"><a href="https://console.upyun.com/#/login/">登录</a></li>
                <li class="reg"><a href="https://console.upyun.com/#/register/">注册</a></li>
            </ul>
        </div>
    </div>
</div>


        <div class="container" id="main-wrapper">
            <div class="toolbar clearfix">
  <ol class="breadcrumb pull-left">
    <li><a href="">文档</a></li>
    <li>图片处理</li>
  </ol>

  
    
      <a href="https://github.com/kougazhang/cdn-docs/" class="github-edit pull-right"><i class="fa fa-github"></i> Edit on GitHub</a>
    
  

</div>
            <div class="bs-sidebar hidden-print toc"  data-spy="affix" data-offset-top="120" role="complementary">
  <ul class="nav bs-sidenav">
    
      

    
      
        
      

    
      
        
      

    
      
        
      

    
      
        
      

    
      
        
          

              <li class="">
                <a class="itm-l1" href="cloud/">产品简介</a>
                
              </li>

          

              <li class="">
                <a class="itm-l1" href="cloud/authorization/">认证鉴权</a>
                
              </li>

          

              <li class="active">
                <a class="itm-l1" href="cloud/image/">图片处理</a>
                
                  <ul class="nav">
                  
                    <li class="active "><a href="#_1">快速入门</a></li>
                    
                  
                    <li class=""><a href="#_2">开发者指南</a></li>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#url">URL 作图</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_3">间隔标识符</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_4">缩略图版本</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_5">上传预处理（同步）</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_6">上传预处理（异步）</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_7">原图保护密钥</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_8">混合使用</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_9">状态码表</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_10">支持格式</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#webp">WebP 开发专题</a></li>
                      </ul>
                    
                  
                    <li class=""><a href="#_11">功能</a></li>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_12">缩小&amp;放大</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_13">裁剪</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_14">水印</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_15">旋转</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_16">锐化</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_17">高斯模糊</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_18">边框</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_19">画布</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_20">属性获取</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_21">结果输出</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_22">主题色提取</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_23">静态图渐变</a></li>
                      </ul>
                    
                  
                  </ul>
                
              </li>

          

              <li class="">
                <a class="itm-l1" href="cloud/av/">异步音视频处理</a>
                
              </li>

          

              <li class="">
                <a class="itm-l1" href="cloud/sync_video/">同步视频处理</a>
                
              </li>

          

              <li class="">
                <a class="itm-l1" href="cloud/sync_audio/">同步音频处理</a>
                
              </li>

          

              <li class="">
                <a class="itm-l1" href="cloud/unzip/">压缩解压缩</a>
                
              </li>

          

              <li class="">
                <a class="itm-l1" href="cloud/spider/">文件拉取</a>
                
              </li>

          

              <li class="">
                <a class="itm-l1" href="cloud/uconvert/">文档转换</a>
                
              </li>

          

              <li class="">
                <a class="itm-l1" href="cloud/async_image/">异步图片拼接</a>
                
              </li>

          

              <li class="">
                <a class="itm-l1" href="cloud/av_pretreatment/">音视频处理（已弃用）</a>
                
              </li>

          
        
      

    
      
        
      

    
      
        
      

    
      
        
      

    
  </ul>


</div>



            <div class="content-body" role="main">

<h1>图片处理</h1>

<h2 id="_1">快速入门<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>又拍云处理（图片处理）基于 CDN 或云存储服务，您在使用它之前，请确保您已经注册又拍云账号并完成实名验证，请确保您已经创建 <a href="/cdn/guide/">CDN 服务</a>或<a href="/api/quick_start/">云存储服务</a>。</p>
<p>收费方面，图片处理完全免费。</p>
<p>相关阅读：<a href="https://www.upyun.com/webp">演示 WebP 如何让您的图片大小平均减少 70%</a>，<a href="#webp">WebP 开发专题</a>。</p>
<hr />
<h2 id="_2">开发者指南<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="url">URL 作图<a class="headerlink" href="#url" title="Permanent link">&para;</a></h3>
<p>通过 URL 访问图片时，对图片进行处理，并把处理后的图片返回。</p>
<p>** URL 作图的格式 **</p>
<pre><code>图片 URL + 间隔标识符 + 参数或缩略图版本
</code></pre>
<p>间隔标识符说明，见<a href="#tag">间隔标识符</a>；参数说明，见<a href="#function">功能</a>；缩略图版本说明，见<a href="#thumb">缩略图版本</a>。</p>
<p>** 例如 **</p>
<p>图片 URL 是 <a href="https://p.upyun.com/docs/cloud/demo.jpg" target="_blank" title="查看"><code>https://p.upyun.com/docs/cloud/demo.jpg</code></a>，</p>
<p>间隔标识符是 <code>!</code>，</p>
<p>功能是 <code>格式转换成 webp</code>，</p>
<p>访问的 URL 是 <a href="https://p.upyun.com/docs/cloud/demo.jpg!/format/webp" target="_blank" title="查看"><code>https://p.upyun.com/docs/cloud/demo.jpg!/format/webp</code></a>。</p>
<hr />
<p><a name="tag"></a></p>
<h3 id="_3">间隔标识符<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>用于分隔图片 URL 和处理信息，有 3 种可选，分别是：<code>!</code>（感叹号/默认值）、<code>-</code>（中划线）和 <code>_</code>（下划线），可登录又拍云<a href="https://console.upyun.com/services/" target="_blank">控制台</a>，在 「服务」 &gt; 「功能配置」 &gt; 「云处理」 中设置。</p>
<hr />
<p><a name="thumb"></a></p>
<h3 id="_4">缩略图版本<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>缩略图版本在又拍云<a href="https://console.upyun.com/services/" target="_blank">控制台</a>，「服务」 &gt; 「功能配置」 &gt; 「云处理」 中创建，它里面包含许多图片处理功能。如下图：</p>
<p><a href="http://upyun-assets.b0.upaiyun.com/docs/process/image_version.png"  target="_blank" title="查看大图"><img src="http://upyun-assets.b0.upaiyun.com/docs/process/image_version.png" height="490" width="800" alt="缩略图版本" /></a></p>
<p>** 例如 **</p>
<p>缩略图版本名称是 <code>upyun520</code>，</p>
<p>访问的 URL 是 <a href="https://p.upyun.com/docs/cloud/demo.jpg!upyun520" target="_blank" title="查看"><code>https://p.upyun.com/docs/cloud/demo.jpg!upyun520</code></a>。</p>
<p>其中，<code>!</code> 是<a href="#tag">间隔标识符</a>。</p>
<hr />
<p><a name="sync_upload_process"></a></p>
<h3 id="_5">上传预处理（同步）<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>在上传图片时，对上传的图片进行处理，并保存处理后的图片到又拍云存储。</p>
<p>支持的 API： <a href="/api/rest_api/#_2">REST API</a> | <a href="/api/form_api/#upload_args">FORM API</a> | <a href="/cloud/spider/">文件拉取</a>。</p>
<p>参数名是 <code>x-gmkerl-thumb</code>，参数值是 <code>参数或缩略图版本</code>。处理参数见<a href="#function">功能</a>。</p>
<p>** 举例 **</p>
<p>例 1：转换图片格式为 png</p>
<pre><code>x-gmkerl-thumb: /format/png
</code></pre>
<p>例 2：限定图片宽度为 300px、锐化、压缩质量 80、存储为 png 格式（参数不区分先后顺序）</p>
<pre><code>x-gmkerl-thumb: /fw/300/unsharp/true/quality/80/format/png
</code></pre>
<hr />
<p><a name="async_upload_process"></a></p>
<h3 id="_6">上传预处理（异步）<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>在上传图片时，对上传的图片进行处理，生成一张或多张新的图片，同时保存上传的图片到又拍云存储。任务以异步的方式处理，处理完成后，回调通知用户处理结果。</p>
<p>支持的 API： <a href="/api/form_api/#upload_args">FORM API</a>。</p>
<p>参数名是 <code>apps</code>，参数值是 JSON 数组。一个 <code>apps</code> 最多允许包含 10 个图片处理任务。</p>
<p>设置了 <code>apps</code> 参数，会创建异步处理任务，否则为同步处理任务</p>
<p>** apps 参数结构 **</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>必选</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>是</td>
<td>使用异步图片处理服务，固定值 <code>thumb</code></td>
</tr>
<tr>
<td>x-gmkerl-thumb</td>
<td>是</td>
<td>图片处理功能参数或缩略图版本名称，处理参数见<a href="#function">功能</a></td>
</tr>
<tr>
<td>x-gmkerl-split</td>
<td>否</td>
<td>图片分块，按 <code>宽x高</code> 把图片分成数块，见「注」</td>
</tr>
<tr>
<td>save_as</td>
<td>否</td>
<td>结果图片保存路径</td>
</tr>
<tr>
<td>notify_url</td>
<td>否</td>
<td>回调地址，不填时使用<a href="/api/form_api/#_2">上传参数</a>中的  <code>notify_url</code></td>
</tr>
</tbody>
</table>
<p>** save_as 支持的变量 **</p>
<table>
<thead>
<tr>
<th>变量名</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>{filepath}</td>
<td>原图在存储中的路径</td>
</tr>
<tr>
<td>{filename}</td>
<td>原图文件名</td>
</tr>
<tr>
<td>{suffix}</td>
<td>原图文件名后缀，不带点</td>
</tr>
<tr>
<td>{row}</td>
<td>切割后小图的位置行号，从 0 开始，从左到右依次增大</td>
</tr>
<tr>
<td>{column}</td>
<td>切割后小图的位置列号，从 0 开始，从上到下依次增大</td>
</tr>
<tr>
<td>{seq}</td>
<td>切割后小图的序列号，从 0 开始，从左到右、从上到下依次增大</td>
</tr>
</tbody>
</table>
<p>** 注 **</p>
<ul>
<li><code>x-gmkerl-split</code> 会在 <code>x-gmkerl-thumb</code> 的基础上把图片分成数块，用户可以根据回调信息中的行号跟列号来确定分块后的图片在原图中的位置。</li>
<li><code>x-gmkerl-split</code> 会输出多个图片，从左上角开始，往右列号从 0 依次增大，往下行号从 0 依次增大，序列号按行从左往右、从上到下、从 0 依次增大。</li>
</ul>
<p>** 举例 **</p>
<pre><code>apps = [
    {                                             
        &quot;name&quot;: &quot;thumb&quot;,
        &quot;x-gmkerl-thumb&quot;: &quot;/fw/300/quality/95&quot;,    
        &quot;save_as&quot;: &quot;/path/to/fw_300.jpg&quot;,          
        &quot;notify_url&quot;: &quot;http://your/notify/url&quot;     
    },
    ......
]
</code></pre>
<p>** 回调通知 **</p>
<p>任务处理完成后，向 <code>notify_url</code> 地址发送回调通知。回调信息为 JSON 格式，字段名及含义如下：</p>
<table>
<thead>
<tr>
<th>字段名</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>task_id</code></td>
<td>string</td>
<td>异步处理任务 ID（在上传时返回）</td>
</tr>
<tr>
<td><code>service</code></td>
<td>string</td>
<td>文件所在空间名</td>
</tr>
<tr>
<td><code>status_code</code></td>
<td>integer</td>
<td>处理结果状态码，<code>200</code> 表示成功处理</td>
</tr>
<tr>
<td><code>imginfo</code></td>
<td>map</td>
<td>输出单张图片信息</td>
</tr>
<tr>
<td><code>imginfos</code></td>
<td>array</td>
<td>输出多张图片信息</td>
</tr>
<tr>
<td><code>error</code></td>
<td>string</td>
<td>错误信息</td>
</tr>
</tbody>
</table>
<p><code>imginfo</code> 、 <code>imginfos</code> 中包含信息如下：</p>
<table>
<thead>
<tr>
<th>字段名</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td>string</td>
<td>作图结果保存路径（<code>save_as</code>参数指定）</td>
</tr>
<tr>
<td><code>type</code></td>
<td>string</td>
<td>图片类型</td>
</tr>
<tr>
<td><code>width</code></td>
<td>integer</td>
<td>图片宽度</td>
</tr>
<tr>
<td><code>height</code></td>
<td>integer</td>
<td>图片高度</td>
</tr>
<tr>
<td><code>frame</code></td>
<td>integer</td>
<td>图片帧数</td>
</tr>
<tr>
<td><code>row</code></td>
<td>integer</td>
<td>相对于左上角的行号，从 <code>0</code> 开始，仅当图片分块时有效</td>
</tr>
<tr>
<td><code>column</code></td>
<td>integer</td>
<td>相对于左上角的列号，从 <code>0</code> 开始，仅当图片分块时有效</td>
</tr>
</tbody>
</table>
<p>** 举例 **</p>
<p>例 1：输出单张图片的回调信息</p>
<pre><code class="language-json">{
    &quot;task_id&quot;: &quot;b52c96bea30646abf8170f333bbd42b9&quot;,
    &quot;service&quot;: &quot;upyun-demo&quot;,
    &quot;status_code&quot;: 200,
    &quot;imginfo&quot;: {
        &quot;path&quot;: &quot;/images/upyun.jpg&quot;,
        &quot;type&quot;: &quot;jpg&quot;,
        &quot;width&quot;: 720,
        &quot;height&quot;: 360,
        &quot;frames&quot;: 1
    }
}
</code></pre>
<p>例 2：输出多张图片（使用了<a href="#async_process">图片分块 x-gmkerl-split</a>） 的回调信息</p>
<pre><code class="language-json">{
    &quot;task_id&quot;: &quot;b52c96bea30646abf8170f333bbd42b9&quot;,
    &quot;service&quot;: &quot;upyun-demo&quot;,
    &quot;status_code&quot;: 200,
    &quot;imginfos&quot;: [
      {
        &quot;path&quot;: &quot;/images/upyun.jpg-1.jpg&quot;,
        &quot;type&quot;: &quot;jpg&quot;,
        &quot;width&quot;: 72,
        &quot;height&quot;: 36,
        &quot;frames&quot;: 1,
        &quot;row&quot;: 0,
        &quot;column&quot;: 0
      },
      {
        &quot;path&quot;: &quot;/images/upyun.jpg-2.jpg&quot;,
        &quot;type&quot;: &quot;jpg&quot;,
        &quot;width&quot;: 72,
        &quot;height&quot;: 36,
        &quot;frames&quot;: 1,
        &quot;row&quot;: 0,
        &quot;column&quot;: 1
      }
    ]
}
</code></pre>
<hr />
<h3 id="_7">原图保护密钥<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<ul>
<li>上传图片时，保护密钥通过 <a href="/api/rest_api/#_2">REST API</a> | <a href="/api/form_api/#_2">FORM API</a> 的 <code>Content-Secret</code> 设置。</li>
<li>已经存在存储的图片，可以通过编辑 <a href="/api/rest_api/#metadata_2">Metadata</a> 设置保护密钥。</li>
</ul>
<p>图片添加保护密钥后，访问时需要带上 「<a href="#tag">间隔标识符</a>」 和 「保护密钥」，才能访问图片。</p>
<p>例如，保护密钥是 <code>abc</code>，</p>
<p>访问图片 URL 是 <a href="https://p.upyun.com/docs/cloud/secret.jpg!abc" target="_blank" title="查看"><code>https://p.upyun.com/docs/cloud/secret.jpg!abc</code></a>。</p>
<p>如果保护密钥跟缩略图版本名称相同，当作保护密钥。特别地，对有保护密钥的图片进行处理时，不需要加保护密钥。</p>
<hr />
<h3 id="_8">混合使用<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>假设存在缩略图版本 <code>upyun520</code>，现在针对某类图片需要调整缩略图版本的配置，比如限定宽度为 500px（<code>/fw/500</code>），可以使用缩略图版本与参数混合，通过参数对缩略图版本进行动态调整。因为，参数的优先级高于缩略图版本。</p>
<p>URL 作图混合使用是：</p>
<p><a href="https://p.upyun.com/docs/cloud/demo.jpg!upyun520/fw/500" target="_blank" title="查看"></p>
<pre><code>https://p.upyun.com/docs/cloud/demo.jpg!upyun520/fw/500
</code></pre>
<p></a> </p>
<p>上传预处理混合使用是： </p>
<pre><code>x-gmkerl-thumb: upyun520/fw/500
</code></pre>
<p>特别地，参数只能出现在缩略图版本的后面，如 <code>/fw/500</code> 出现在 <code>upyun520</code> 后面。</p>
<hr />
<h3 id="_9">状态码表<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>状态码</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>处理成功</td>
</tr>
<tr>
<td>400</td>
<td>参数错误，返回 JSON 中包含具体错误信息</td>
</tr>
<tr>
<td>404</td>
<td>指定 Profile 信息不存，Not Profile</td>
</tr>
<tr>
<td>405</td>
<td>图片数据无效，Not an image</td>
</tr>
<tr>
<td>405</td>
<td>图片宽高超出限制，Image Width/Height Limit Error</td>
</tr>
<tr>
<td>406</td>
<td>非图片获取图片基本信息时数据无效，Not an image</td>
</tr>
<tr>
<td>409</td>
<td>图片大小超出限制，限制为 2 亿像素，Limit Exceeded</td>
</tr>
<tr>
<td>413</td>
<td>请求处理超时，A Big Image!</td>
</tr>
<tr>
<td>5xx</td>
<td>服务端错误。如遇此类错误，请反馈给<a href="https://www.upyun.com/contact">售后</a>或您的商务经理</td>
</tr>
</tbody>
</table>
<p>上传预处理的更多错误码，请查询 <a href="/api/errno/#api">API 错误码表</a>。</p>
<hr />
<h3 id="_10">支持格式<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>类型</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>输入格式</td>
<td>JPG、JPEG、PNG、WebP、动态 WebP、GIF、动态 GIF、BMP、SVG等</td>
</tr>
<tr>
<td>输出格式</td>
<td>JPG、PNG、WebP、动态 WebP</td>
</tr>
</tbody>
</table>
<p>** 其他约束 **</p>
<ul>
<li>图片宽或高最大不能超过 2 万像素，「宽 * 高 * 帧数」最大不能超过 2 亿。</li>
</ul>
<hr />
<h3 id="webp">WebP 开发专题<a class="headerlink" href="#webp" title="Permanent link">&para;</a></h3>
<p>** 有损 WebP 演示 **：<a href="https://www.upyun.com/webp.html">WebP 如何让您的图片大小平均减少 70%</a></p>
<p>** 无损 WebP 指南 **：<a href="https://blog.upyun.com/?p=1595">无损 WebP 正确的使用姿势</a></p>
<p>** 转成有损 WebP **：<code>/format/webp</code></p>
<p>** 转成无损 WebP **：<code>/format/webp/lossless/true</code></p>
<p>** 示例 **</p>
<p>JPG 转成有损 WebP：www.domain.com/a.jpg!/format/webp</p>
<p>PNG 转成无损 WebP：www.domain.com/a.png!/format/webp/lossless/true</p>
<p>GIF/动态 GIF 转成有损 WebP：www.domain.com/a.gif!/format/webp</p>
<p>SVG 转成无损 WebP：www.domain.com/a.svg!/format/webp/lossless/true</p>
<p><code>!</code> 是<a href="#tag">间隔标识符</a>，<code>/format/webp</code>、<code>/lossless/true</code> 更多解释见「功能」&gt; <a href="#output">结果输出</a>。</p>
<hr />
<p><a name="function"></a></p>
<h2 id="_11">功能<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<h3 id="_12">缩小&amp;放大<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/fw/&lt;width&gt;</code></td>
<td>宽，如 300</td>
<td>限定宽度，高度自适应</td>
</tr>
<tr>
<td><code>/fh/&lt;height&gt;</code></td>
<td>高，如 200</td>
<td>限定高度，宽度自适应</td>
</tr>
<tr>
<td><code>/max/&lt;max&gt;</code></td>
<td>最长边，如 200</td>
<td>限定最长边，短边自适应</td>
</tr>
<tr>
<td><code>/min/&lt;min&gt;</code></td>
<td>最短边，如 200</td>
<td>限定最短边，长边自适应</td>
</tr>
<tr>
<td><code>/fwfh/&lt;w&gt;x&lt;h&gt;</code></td>
<td>宽x高，如 300x200</td>
<td>限定宽度或高度，宽高不足时不缩放</td>
</tr>
<tr>
<td><code>/fwfh2/&lt;w&gt;x&lt;h&gt;</code></td>
<td>宽x高，如 300x200</td>
<td>限定宽度最小值和高度最小值，宽高不足时不缩放</td>
</tr>
<tr>
<td><code>/both/&lt;w&gt;x&lt;h&gt;</code></td>
<td>宽x高，如 300x200</td>
<td>固定宽度和高度，宽高不足时居中裁剪再缩放 <br /> 特别地，配合 <code>/force/true</code> 使用时，宽高不足时只缩放，不裁剪</td>
</tr>
<tr>
<td><code>/sq/&lt;w&gt;</code></td>
<td>宽或高，如 300</td>
<td>图片缩放成正方形，宽高相等</td>
</tr>
<tr>
<td><code>/scale/&lt;scale&gt;</code></td>
<td>缩放比例，如 50</td>
<td>宽高等比例缩放，取值范围 <code>[1-1000]</code></td>
</tr>
<tr>
<td><code>/wscale/&lt;wscale&gt;</code></td>
<td>宽度缩放比例，如 200</td>
<td>宽度按比例缩放，高度不变，取值范围 <code>[1-1000]</code></td>
</tr>
<tr>
<td><code>/hscale/&lt;hscale&gt;</code></td>
<td>高度缩放比例，如 200</td>
<td>高度按比例缩放，宽度不变，取值范围 <code>[1-1000]</code></td>
</tr>
<tr>
<td><code>/fxfn/&lt;max&gt;x&lt;min&gt;</code></td>
<td>长边x短边，如 300x200</td>
<td>限定长边或短边，进行等比缩放，不裁剪</td>
</tr>
<tr>
<td><code>/fxfn2/&lt;max&gt;x&lt;min&gt;</code></td>
<td>长边x短边，如 300x200</td>
<td>限定长边最小值和短边最小值，进行等比缩放，不裁剪</td>
</tr>
<tr>
<td><code>/fp/&lt;integer&gt;</code></td>
<td>宽高像素积，如 200000</td>
<td>宽高等比例缩放，直到宽高像素积小于但最接近指定值，取值范围 <code>[1-25000000]</code></td>
</tr>
<tr>
<td><code>/force/&lt;boolean&gt;</code></td>
<td>true</td>
<td>不支持放大的参数，指定 <code>/force/</code> 为 <code>true</code> 进行放大，默认 <code>false</code></td>
</tr>
</tbody>
</table>
<p>** 注 **</p>
<ul>
<li><code>fwfh</code> 当原图宽与期望缩放的宽的比例大于原图高与期望缩放的高的比例时，是 <code>fw</code>；否则，是 <code>fh</code>。</li>
<li><code>scale</code> 值取 <code>20</code> 时，缩小后的图片宽高是原图宽高的 <code>20%</code>；取 <code>200</code> 时，放大后的图片宽高是原图宽高的 <code>200%</code>。</li>
<li>特别地，大部分参数默认不支持放大，如果需要放大，请指定 <code>/force/true</code> 。</li>
<li><code>&lt;w&gt;x&lt;h&gt;</code> 中的 <code>x</code> 是小写字母 x，不是乘号。</li>
</ul>
<hr />
<p><a name="crop"></a></p>
<h3 id="_13">裁剪<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/crop/&lt;w&gt;x&lt;h&gt;a&lt;x&gt;a&lt;y&gt;</code></td>
<td>宽x高axay，如 300x200a80a60</td>
<td>缩小或放大前进行裁剪</td>
</tr>
<tr>
<td><code>/clip/&lt;w&gt;x&lt;h&gt;a&lt;x&gt;a&lt;y&gt;</code></td>
<td>宽x高axay，如 300x200a80a60</td>
<td>缩小或放大后进行裁剪</td>
</tr>
<tr>
<td><code>/gravity/&lt;gravity&gt;</code></td>
<td>位置，如 north</td>
<td>裁剪开始的方位，默认 <code>northwest</code>，详见<a href="#align_gravity">方位说明</a> <br /> 特别地，<code>/gravity</code> 需要放在 <code>/crop</code> 或 <code>/clip</code> 的后面</td>
</tr>
<tr>
<td><code>/roundrect/&lt;roundrect&gt;</code></td>
<td>圆角半径，如 20</td>
<td>裁剪时对四角进行圆化（圆角裁剪），默认 <code>10</code></td>
</tr>
</tbody>
</table>
<p>** 注 **</p>
<ul>
<li><code>&lt;w&gt;x&lt;h&gt;</code> 中的 <code>x</code> 是小写字母 x，不是乘号。当 <code>&lt;w&gt;x&lt;h&gt;</code> 是 <code>0x0</code> 时，自动根据偏移量计算裁剪图片宽、高。</li>
<li><code>a&lt;x&gt;s&lt;y&gt;</code> 中的 <code>&lt;x&gt;</code>、<code>&lt;y&gt;</code> 表示偏移量，<code>a</code>、<code>s</code> 表示正、负，<code>x</code> 正负判断依据是：往 <code>east</code> 方向偏移，为 <code>a</code>；往 <code>west</code> 方向偏移，为 <code>s</code>; <code>y</code> 正负判断依据是：往 <code>south</code> 方向偏移，为 <code>a</code>；往 <code>north</code> 方向偏移，为 <code>s</code>。</li>
</ul>
<hr />
<p><a name="watermark"></a></p>
<h3 id="_14">水印<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<p>** 图片水印 **</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/watermark/url/&lt;url&gt;</code></td>
<td>编码字符串，如 <code>L3BhdGgvdG8vd2F0ZXJtYXJrLnBuZw==</code></td>
<td>水印图片的 URI，示例为 <code>/path/to/watermark.png</code> 的 Base64 编码字符串。特别地，水印图片必须和待处理图片在同一服务名下</td>
</tr>
<tr>
<td><code>/align/&lt;align&gt;</code></td>
<td>位置，如 north</td>
<td>水印图片放置方位，默认 <code>northwest</code>，详见<a href="#align_gravity">方位说明</a></td>
</tr>
<tr>
<td><code>/margin/&lt;x&gt;x&lt;y&gt;</code></td>
<td>横偏移x纵偏移，如 15x10</td>
<td>水印图片横纵相对偏移，默认 <code>20x20</code></td>
</tr>
<tr>
<td><code>/opacity/&lt;opacity&gt;</code></td>
<td>透明度，如 90</td>
<td>水印图片透明度，默认 <code>100</code>，取值范围 <code>[0-100]</code>，值越大越不透明，<code>0</code> 完全透明，<code>100</code> 完全不透明</td>
</tr>
<tr>
<td><code>/percent/&lt;integer&gt;</code></td>
<td>百分比值，如 50</td>
<td>水印图片自适应原图短边的比例，取值范围 <code>[0-100]</code>，默认 <code>0</code>，<code>0</code> 表示不设置该参数</td>
</tr>
<tr>
<td><code>/repeat/&lt;boolean&gt;</code></td>
<td>true</td>
<td>水印图片是否重复铺满原图，默认 <code>false</code></td>
</tr>
<tr>
<td><code>/animate/&lt;boolean&gt;</code></td>
<td>true</td>
<td>允许对动态图片加水印，默认 <code>false</code></td>
</tr>
</tbody>
</table>
<p>** 文字水印 **</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/watermark/text/&lt;text&gt;</code></td>
<td>文字内容，如 <code>5L2g5aW977yB</code></td>
<td>文字内容，示例中为 <code>你好！</code>的 Base64 编码字符串。</td>
</tr>
<tr>
<td><code>/size/&lt;size&gt;</code></td>
<td>大小，如 16</td>
<td>文字大小，单位 px，默认 <code>32</code></td>
</tr>
<tr>
<td><code>/font/&lt;font&gt;</code></td>
<td>字体，如 simsun（宋体）</td>
<td>文字字体，默认 <code>simsun</code>。字体使用时，需要用参数名。参数名见<a href="#font_list">字体列表</a></td>
</tr>
<tr>
<td><code>/color/&lt;color&gt;</code></td>
<td>RRGGBB，如 FF0000（红色）</td>
<td>字体颜色，默认 <code>000000（黑色）</code></td>
</tr>
<tr>
<td><code>/border/&lt;border&gt;</code></td>
<td>RRGGBBAA，如 FF000000（不透明红色）</td>
<td>文字描边，默认 <code>FFFFFFFF（透明白色）</code>，详见 <a href="#border">border 说明</a></td>
</tr>
<tr>
<td><code>/align/&lt;align&gt;</code></td>
<td>位置，如 north</td>
<td>文字放置方位，默认 <code>northwest</code>，详见<a href="#align_gravity">方位说明</a></td>
</tr>
<tr>
<td><code>/margin/&lt;x&gt;x&lt;y&gt;</code></td>
<td>横偏移x纵偏移，如 15x10</td>
<td>文字横纵相对偏移，默认 <code>20x20</code></td>
</tr>
<tr>
<td><code>/opacity/&lt;opacity&gt;</code></td>
<td>透明度，如 90</td>
<td>文字透明度，默认 <code>100</code>，取值范围 <code>[0-100]</code>，值越大越不透明，<code>0</code> 完全透明，<code>100</code> 完全不透明</td>
</tr>
<tr>
<td><code>/animate/&lt;boolean&gt;</code></td>
<td>true</td>
<td>允许对动态图片加水印，默认 <code>false</code></td>
</tr>
</tbody>
</table>
<p>** 多个水印 **</p>
<p>把图片水印或文字水印参数重复。例如，一个文字水印 + 一个图片水印：</p>
<p><a href="https://p.upyun.com/docs/cloud/demo.jpg!/watermark/text/5L2g5aW977yB/font/simhei/watermark/url/L2RvY3MvY2xvdWQvdXB5dW4tbG9nby5wbmc=/align/southeast" target="_blank" title="查看演示"></p>
<pre><code>/watermark/text/5L2g5aW977yB/font/simhei/watermark/url/L2RvY3MvY2xvdWQvdXB5dW4tbG9nby5wbmc=/align/southeast
</code></pre>
<p></a></p>
<p>特别地，水印个数越多，处理耗时越长，建议不要超过 3 个。</p>
<p>** 注 **</p>
<ul>
<li>图片水印的 <code>url</code> 需要 base64 编码，并把编码后的字符串中的 <code>/</code>（斜杠）替换成 <code>|</code>（竖线）。</li>
<li><a name="align_gravity"></a><code>align</code> 或 <code>gravity</code> 的 9 个方位：</li>
</ul>
<pre><code>    northwest     |     north      |     northeast
                  |                |
                  |                |
    --------------+----------------+--------------
                  |                |
    west          |     center     |          east
                  |                |
    --------------+----------------+--------------
                  |                |
                  |                |
    southwest     |     south      |     southeast
</code></pre>
<ul>
<li>文字水印的 <code>text</code> 需要 base64 编码，并把编码后的字符串中的 <code>/</code>（斜杠）替换成 <code>|</code>（竖线）。</li>
<li>文字水印的中含中文内容（<code>text</code>）时，字体（<code>font</code>）请使用中文字体，否则会乱码。</li>
<li><a name="font_list"></a>字体列表：</li>
</ul>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>参数名</th>
</tr>
</thead>
<tbody>
<tr>
<td>宋体</td>
<td>中文字体</td>
<td>simsun</td>
</tr>
<tr>
<td>黑体</td>
<td>中文字体</td>
<td>simhei</td>
</tr>
<tr>
<td>楷体</td>
<td>中文字体</td>
<td>simkai</td>
</tr>
<tr>
<td>隶书</td>
<td>中文字体</td>
<td>simli</td>
</tr>
<tr>
<td>幼圆</td>
<td>中文字体</td>
<td>simyou</td>
</tr>
<tr>
<td>仿宋</td>
<td>中文字体</td>
<td>simfang</td>
</tr>
<tr>
<td>简体中文</td>
<td>中文字体</td>
<td>sc</td>
</tr>
<tr>
<td>繁体中文</td>
<td>中文字体</td>
<td>tc</td>
</tr>
<tr>
<td>Arial</td>
<td>英文字体</td>
<td>arial</td>
</tr>
<tr>
<td>Georgia</td>
<td>英文字体</td>
<td>georgia</td>
</tr>
<tr>
<td>Helvetica</td>
<td>英文字体</td>
<td>helvetica</td>
</tr>
<tr>
<td>Times-New-Roman</td>
<td>英文字体</td>
<td>roman</td>
</tr>
</tbody>
</table>
<ul>
<li><a name="border"></a><code>border</code> 的值 <code>RRGGBBAA</code>，<code>RRGGBB</code> 表示边框颜色；<code>AA</code> 表示不透明度，取值 <code>[0-255]</code>，值越大越透明，<code>00</code> 表示完全不透明，<code>FF</code> 表示完全透明。</li>
<li><code>&lt;x&gt;x&lt;y&gt;</code> 中，连接 <code>&lt;x&gt;</code>与<code>&lt;y&gt;</code>是小写字母 x，不是乘号。</li>
</ul>
<hr />
<p><a name="rotate"></a></p>
<h3 id="_15">旋转<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/rotate/&lt;固定值&gt;</code></td>
<td>auto</td>
<td>自动扶正</td>
</tr>
<tr>
<td><code>/rotate/&lt;angle&gt;</code></td>
<td><code>(0, 360]</code>，如 90°</td>
<td>按角度旋转</td>
</tr>
</tbody>
</table>
<p>** 翻转 **</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/flip/&lt;orientation&gt;</code></td>
<td>方向，如 <code>left,right</code></td>
<td>翻转方向，可选值：<code>left,right</code>、<code>top,down</code></td>
</tr>
</tbody>
</table>
<p>** 注 **</p>
<ul>
<li><code>left,right</code> 表示从左向右翻转，<code>top,down</code> 表示从上向下翻转。</li>
</ul>
<hr />
<p><a name="unsharp"></a></p>
<h3 id="_16">锐化<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p>提高图片模糊部位的清晰度或聚焦程度。</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/unsharp/&lt;boolean&gt;</code></td>
<td>true</td>
<td>锐化，默认 <code>false</code></td>
</tr>
</tbody>
</table>
<hr />
<h3 id="_17">高斯模糊<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p>减少图片噪音和降低图片细节层次，使图片模糊化。</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/gaussblur/&lt;radius&gt;x&lt;sigma&gt;</code></td>
<td>模糊半径x标准差，如 5x2</td>
<td>高斯模糊</td>
</tr>
</tbody>
</table>
<p>** 注 **</p>
<ul>
<li><code>0 &lt;= radius &lt;= 50</code> 且 <code>radius</code> 是整数，<code>sigma</code> 是正整数。当 <code>radius = 0</code> 时，<code>raduis</code> 根据 <code>sigma</code> 自动计算产生。</li>
<li><code>&lt;radius&gt;x&lt;sigma&gt;</code> 中的 <code>x</code> 是小写字母 x，不是乘号。</li>
</ul>
<hr />
<h3 id="_18">边框<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>为图片添加边框，支持设置边框颜色。</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/border/&lt;w&gt;x&lt;h&gt;</code></td>
<td>宽x高，如 3x2</td>
<td>边框尺寸，<code>w</code> 表示左右边框宽度，<code>h</code> 表示上下边框宽度</td>
</tr>
<tr>
<td><code>/brdcolor/&lt;brdcolor&gt;</code></td>
<td>RRGGBBAA，如 FF000000（红色不透明）</td>
<td>边框颜色和透明度，默认 <code>FFFFFF00（白色不透明）</code></td>
</tr>
</tbody>
</table>
<p>** 注 **</p>
<ul>
<li><code>brdcolor</code> 的值 <code>RRGGBBAA</code>，<code>RRGGBB</code> 表示边框颜色；<code>AA</code> 表示不透明度，取值 <code>[0-255]</code>，值越大越透明，<code>00</code> 表示完全不透明，<code>FF</code> 表示完全透明。</li>
<li><code>&lt;w&gt;x&lt;h&gt;</code> 中的 <code>x</code> 是小写字母 x，不是乘号。</li>
</ul>
<hr />
<p><a name="canvas"></a></p>
<h3 id="_19">画布<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<p>为图片添加画布，相当于把图片放入画布中。</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/canvas/&lt;w&gt;x&lt;h&gt;a&lt;x&gt;a&lt;y&gt;</code></td>
<td>宽x高axay，如 600x400a50a20</td>
<td>画布尺寸，<code>w</code> 表示画布宽，<code>h</code> 表示画布高，<code>x</code>、<code>y</code> 表示图片左上角在画布中的坐标，如果 <code>x</code>、<code>y</code> 不存在，则图片在画布中间</td>
</tr>
<tr>
<td><code>/cvscolor/&lt;cvscolor&gt;</code></td>
<td>RRGGBBAA，如 FF000000（红色不透明）</td>
<td>边框颜色和透明度，默认 FFFFFF00（白色不透明）</td>
</tr>
</tbody>
</table>
<p>** 注 **</p>
<ul>
<li><code>cvscolor</code> 的值 <code>RRGGBBAA</code>，<code>RRGGBB</code> 表示边框颜色；<code>AA</code> 表示不透明度，取值 <code>[0-255]</code>，值越大越透明，<code>00</code> 表示完全不透明，<code>FF</code> 表示完全透明。</li>
<li><code>&lt;w&gt;x&lt;h&gt;</code> 中的 <code>x</code> 是小写字母 x，不是乘号。</li>
</ul>
<hr />
<p><a name="attribute"></a></p>
<h3 id="_20">属性获取<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/info</code></td>
<td>无</td>
<td>获取基本信息（包括宽、高、格式、帧数）</td>
</tr>
<tr>
<td><code>/meta</code></td>
<td>无</td>
<td>获取 EXIF 信息 + 基本信息</td>
</tr>
<tr>
<td><code>/meta/&lt;固定值&gt;</code></td>
<td>iptc</td>
<td>获取 IPTC 信息 + 基本信息</td>
</tr>
<tr>
<td><code>/meta/&lt;固定值&gt;</code></td>
<td>all</td>
<td>获取图片所有信息，当前是 EXIF 信息 + IPTC 信息 + 基本信息</td>
</tr>
</tbody>
</table>
<p>** 注 **</p>
<ul>
<li>上传预处理时，响应信息中默认包含图片基本信息（<code>info</code>），获取其他图片信息，见 <a href="/api/form_api/#_2">FORM API</a> 中的 <code>x-gmkerl-type</code> 参数。</li>
<li><code>/meta/all</code> 获取到的信息会随着平台支持的信息增多而变化，请在使用时注意。</li>
</ul>
<hr />
<p><a name="output"></a></p>
<h3 id="_21">结果输出<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/format/&lt;format&gt;</code></td>
<td>图片格式，如 jpg</td>
<td>输出格式，可选值 <code>jpg</code>、<code>png</code>、<code>webp</code>。<code>webp</code> 包含动态 WebP</td>
</tr>
<tr>
<td><code>/lossless/&lt;boolean&gt;</code></td>
<td>true</td>
<td>无损压缩，默认 <code>false</code>。仅当输出格式是 <code>WebP</code> 时有效</td>
</tr>
<tr>
<td><code>/quality/&lt;quality&gt;</code></td>
<td>整数值，如 75</td>
<td>设置压缩质量，可选范围<code>[1-99]</code></td>
</tr>
<tr>
<td><code>/compress/&lt;boolean&gt;</code></td>
<td>true</td>
<td>JPG 、 PNG 大小压缩优化，默认 <code>false</code></td>
</tr>
<tr>
<td><code>/coalesce/&lt;boolean&gt;</code></td>
<td>false</td>
<td>是否填充动态 GIF 图像中共同部分，默认 <code>true</code>，见「注」</td>
</tr>
<tr>
<td><code>/progressive/&lt;boolean&gt;</code></td>
<td>true</td>
<td>JPG 图片渐进式加载，图片加载从模糊到清晰</td>
</tr>
<tr>
<td><code>/noicc/&lt;boolean&gt;</code></td>
<td>true</td>
<td>清除图片 ICC 信息，默认 <code>false</code></td>
</tr>
<tr>
<td><code>/strip/&lt;boolean&gt;</code></td>
<td>true</td>
<td>去除图片所有元信息，包括 EXIF 、ICC 等。默认 <code>false</code></td>
</tr>
<tr>
<td><code>/gifto/&lt;boolean&gt;</code></td>
<td>true</td>
<td>多帧 GIF 图片转为单帧 GIF 图片</td>
</tr>
<tr>
<td><code>/exifswitch/&lt;boolean&gt;</code></td>
<td>true</td>
<td>保留 EXIF 信息 ，默认会删除 EXIF 信息</td>
</tr>
<tr>
<td><code>/ignore-error/&lt;boolean&gt;</code></td>
<td>true</td>
<td>是否忽略错误返回原图 ，默认 <code>false</code>，返回错误</td>
</tr>
</tbody>
</table>
<p>** 注 **</p>
<ul>
<li>一般来说，<code>quality（质量）</code> 是 <code>75</code>，在这个值压缩大小与图片质量损失得到平衡。</li>
<li><code>compress</code> 会对 JPG/PNG 进行一次压缩以减少图片体积，同时稍微延长了图片处理时间、降低了图片质量。</li>
<li><code>noicc</code> 会导致图片质量轻微的下降。</li>
<li>大部分动态 GIF 可以通过省略相邻帧之间共同部分来优化图片体积。如果 <code>coalesce</code> 参数为 <code>false</code>，当对动态 GIF 做缩略或放大时，可能会导致图片质量下降。 </li>
<li><code>ignore-error</code> 只对 405、409、503 状态码有效，并会在响应头中附加 <code>x-gmkerl-err-code</code> 字段标记实际错误码。其他错误状态码无效，返回错误。</li>
</ul>
<hr />
<h3 id="_22">主题色提取<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/excolor/&lt;integer&gt;</code></td>
<td>颜色数量，如 128</td>
<td>提取的颜色数量。可选值：<code>[1-4096]</code></td>
</tr>
<tr>
<td><code>/exformat/&lt;exformat&gt;</code></td>
<td>颜色进制，如 hex</td>
<td>返回颜色的进制，默认 <code>dec</code>。可选值：<code>dec</code>、<code>hex</code></td>
</tr>
</tbody>
</table>
<p>** 注 **</p>
<ul>
<li>以 JSON 格式返回颜色。<code>hex（十六进制）</code> 表示颜色为 <code>0xRRGGBB</code>，如 <code>0xff00aa</code>；<code>dec（十进制）</code> 表示颜色为 <code>12345678</code>。</li>
</ul>
<hr />
<h3 id="_23">静态图渐变<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/gdori/&lt;orientation&gt;</code></td>
<td>方向，如 top,down（自上而下）</td>
<td>渐变方向</td>
</tr>
<tr>
<td><code>/gdpos/&lt;gdpos&gt;</code></td>
<td>开始位置,结束位置，如 10,100</td>
<td>渐变从开始位置至结束位置。单位像素（px）</td>
</tr>
<tr>
<td><code>/gdstartcolor/&lt;gdstartcolor&gt;</code></td>
<td>RRGGBBAA，如 FF000000（红色不透明）</td>
<td>开始位置颜色及透明度</td>
</tr>
<tr>
<td><code>/gdstopcolor/&lt;gdstopcolor&gt;</code></td>
<td>RRGGBBAA，如 FF000000（红色不透明）</td>
<td>结束位置颜色及透明度</td>
</tr>
</tbody>
</table>
<p>** 注 **</p>
<ul>
<li><code>gdori</code> 取值：<code>top,down</code>（自上而下）、<code>bottom,up</code>（自下而上）、<code>left,right</code>（自左向右）、<code>right,left</code>（自右向左）。</li>
<li><code>RRGGBBAA</code>：<code>RRGGBB</code> 表示边框颜色；<code>AA</code> 表示不透明度，取值 <code>[0-255]</code>，值越大越透明，<code>00</code> 表示完全不透明，<code>FF</code> 表示完全透明。</li>
</ul>
<hr />
<p>如有疑问请 <a href="https://www.upyun.com/contact">联系我们</a></p></div>
        </div>

        

        <script src="../../js/jquery.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script src="../../js/prettify.min.js"></script>
        <script src="../../js/main.js"></script>
        <script src="../../search/main.js"></script>

        <div id="go-top" data-toggle="tooltip" data-placement="bottom" title="回到顶部"><i class="fa fa-arrow-circle-up"></i></div>

        <footer class="footer clearfix">
    <div class="container">
        <ul class="list-unstyled list-inline pull-left">
            <li><a href="/faq/">FAQ</a></li>
            <!-- <li><a href="Blog"></a></li> -->
            <li><a href="https://github.com/upyun">GitHub</a></li>
            <li><a href="https://segmentfault.com/upyun">技术问答</a></li>
            <li><a href="https://www.upyun.com/zh/join_us.html">加入我们</a></li>
        </ul>
        <p class="pull-right">&copy; 2019 又拍云</p>
    </div>
</footer>
        <script type="text/javascript">(function(){document.write(unescape('%3Cdiv id="bdcs"%3E%3C/div%3E'));var bdcs = document.createElement('script');bdcs.type = 'text/javascript';bdcs.async = true;bdcs.src = 'http://znsv.baidu.com/customer_search/api/js?sid=6062249992052412388' + '&plate_url=' + encodeURIComponent(window.location.href) + '&t=' + Math.ceil(new Date()/3600000);var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(bdcs, s);})();
        </script>
    </body>
</html>