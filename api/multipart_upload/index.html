
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://kougazhang.github.io/cdn-docs/api/multipart_upload/">
      
      
        <link rel="prev" href="../fusion_storage/">
      
      
        <link rel="next" href="../errno/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.3.1">
    
    
      
        <title>分块上传（已弃用） - CDN Documents v0.0.1</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.046329b4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CDN Documents v0.0.1" class="md-header__button md-logo" aria-label="CDN Documents v0.0.1" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CDN Documents v0.0.1
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              分块上传（已弃用）
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/kougazhang/cdn-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CDN Documents v0.0.1" class="md-nav__button md-logo" aria-label="CDN Documents v0.0.1" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    CDN Documents v0.0.1
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kougazhang/cdn-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    文档首页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Developer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nginx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../openresty/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Openresty
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CDN
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            CDN
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cdn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内容总览
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cdn/product/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    产品介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cdn/guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    快速入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cdn/buy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    购买指南
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cdn/service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    服务管理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cdn/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    功能配置
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cdn/edgerules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    边缘规则
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cdn/analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    统计分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cdn/refresh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    刷新预热
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cdn/log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    日志管理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cdn/ssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    证书服务
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cdn/tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    辅助工具
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cdn/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    常见问题
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    直播
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            直播
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../live/Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    产品简介
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../live/guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    快速入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../live/primary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    基础配置
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../live/advanced/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    增值服务
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../live/mobile-sdk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    移动端 sdk
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    点播&短视频
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            点播&短视频
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../video/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    短视频简介
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../video/short_video_demo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    短视频 DEMO
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    云存储
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            云存储
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    产品简介
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../quick_start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    快速入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../developer_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    开发者指南
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../authorization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    认证鉴权
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../rest_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../form_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FORM API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../developer_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    开发者工具
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sdk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDK 使用文档
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../fusion_storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    融合云存储
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    分块上传（已弃用）
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    分块上传（已弃用）
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    API 基本域名
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    名称概念
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#signature-policy" class="md-nav__link">
    signature 和 policy 算法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    上传步骤
  </a>
  
    <nav class="md-nav" aria-label="上传步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    初始化上传
  </a>
  
    <nav class="md-nav" aria-label="初始化上传">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    请求类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    请求参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    参数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    返回结果
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    分块上传数据
  </a>
  
    <nav class="md-nav" aria-label="分块上传数据">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    请求类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    请求参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    参数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    返回结果
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    文件合并完成上传
  </a>
  
    <nav class="md-nav" aria-label="文件合并完成上传">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    请求类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    请求参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    参数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    返回结果
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    错误代码说明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../errno/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API 错误码表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../purge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    缓存刷新
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../small_program/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    微信小程序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mobile-stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    移动流量
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../sms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    短信服务
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    云处理
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            云处理
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    产品简介
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/authorization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    认证鉴权
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    图片处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/av/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    异步音视频处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/sync_video/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    同步视频处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/sync_audio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    同步音频处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/unzip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    压缩解压缩
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/spider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    文件拉取
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/uconvert/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    文档转换
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/async_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    异步图片拼接
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/av_pretreatment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    音视频处理（已弃用）
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    人工智能
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            人工智能
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ai/audit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内容识别(有存储)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ai/audit_nostorage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内容识别(无存储)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ai/api_console/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内容处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ai/authorization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    认证鉴权
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ai/face_detect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    人脸识别
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SDK&工具
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            SDK&工具
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../download/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDK&工具
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    常见问题
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            常见问题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    常见问题
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    API 基本域名
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    名称概念
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#signature-policy" class="md-nav__link">
    signature 和 policy 算法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    上传步骤
  </a>
  
    <nav class="md-nav" aria-label="上传步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    初始化上传
  </a>
  
    <nav class="md-nav" aria-label="初始化上传">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    请求类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    请求参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    参数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    返回结果
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    分块上传数据
  </a>
  
    <nav class="md-nav" aria-label="分块上传数据">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    请求类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    请求参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    参数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    返回结果
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    文件合并完成上传
  </a>
  
    <nav class="md-nav" aria-label="文件合并完成上传">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    请求类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    请求参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    参数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    返回结果
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    错误代码说明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>分块上传（已弃用）</h1>

<p>在上传大文件的时候，面对有可能因为网络质量等其他原因而造成的上传失败，使用分块上传和断点续传机制就显得非常有必要。</p>
<blockquote>
<p>云存储完善了断点续传机制，新的断点续传比分快上传更快、更简单，因此，分块上传不再更新，敬请使用<a href="/api/rest_api/#Multi_upload">新的断点续传</a>。</p>
</blockquote>
<h2 id="api">API 基本域名<a class="headerlink" href="#api" title="Permanent link">&para;</a></h2>
<pre><code>m0.api.upyun.com
</code></pre>
<h2 id="_1">名称概念<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>文件分块：直接切分二进制文件成小块。具体文件的每个分块的大小以及分块数目，可以根据自己情况调整（eg. 10MB 的文件，可以定每个分块 1MB，则分块数目即为 10 块）</li>
<li>请求参数（Request Params）： 即是指常规的请求中所带参数</li>
<li>参数组（Meta Params）： 包含文件上传存储及校验相关的必要信息，也是每次请求时候计算 <code>policy</code> 和 <code>signature</code> 所需的参数组。</li>
<li>signature： 校验签名</li>
<li>policy： 存储/校验信息</li>
</ul>
<h2 id="signature-policy">signature 和 policy 算法<a class="headerlink" href="#signature-policy" title="Permanent link">&para;</a></h2>
<p>signature 和 policy 算法与表单 API 相同，请参考 <a href="/api/form_api/#policy">这里</a>。</p>
<blockquote>
<p>注：在分块上传数据和合并文件请求中，需要将此处所用『表单 API 验证密钥』替换为上次请求返回的 <code>token_secret</code>，再进行 <code>signature</code> 计算</p>
</blockquote>
<p>假设一个请求所需的的策略参数如下表:</p>
<table>
<thead>
<tr>
<th>键</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>/demo.png</td>
</tr>
<tr>
<td>expiration</td>
<td>1409200758</td>
</tr>
<tr>
<td>file_blocks</td>
<td>1</td>
</tr>
<tr>
<td>file_hash</td>
<td>b1143cbc07c8e768d517fa5e73cb79ca</td>
</tr>
<tr>
<td>file_size</td>
<td>653252</td>
</tr>
</tbody>
</table>
<p>另设，该空间『表单 API 验证密钥』为：<code>cAnyet74l9hdUag34h2dZu8z7gU=</code></p>
<p>计算 policy 和 signature 相应步骤所得结果如下：</p>
<p>第一步，将参数组转换为 JSON 字符串后：</p>
<pre><code>{&quot;path&quot;:&quot;/demo.png&quot;,&quot;expiration&quot;:1409200758,&quot;file_blocks&quot;:1,&quot;file_size&quot;:653252,&quot;file_hash&quot;:&quot;b1143cbc07c8e768d517fa5e73cb79ca&quot;}
</code></pre>
<p>第二步，将第一步所得字符串 base64 编码后：</p>
<pre><code>eyJwYXRoIjoiL2RlbW8ucG5nIiwiZXhwaXJhdGlvbiI6MTQwOTIwMDc1OCwiZmlsZV9ibG9ja3MiOjEsImZpbGVfc2l6ZSI6NjUzMjUyLCJmaWxlX2hhc2giOiJiMTE0M2NiYzA3YzhlNzY4ZDUxN2ZhNWU3M2NiNzljYSJ9
</code></pre>
<p>第三步，第二步结果与『表单 API 验证密钥』用 <code>&amp;</code> 拼接后：</p>
<pre><code>eyJwYXRoIjoiL2RlbW8ucG5nIiwiZXhwaXJhdGlvbiI6MTQwOTIwMDc1OCwiZmlsZV9ibG9ja3MiOjEsImZpbGVfc2l6ZSI6NjUzMjUyLCJmaWxlX2hhc2giOiJiMTE0M2NiYzA3YzhlNzY4ZDUxN2ZhNWU3M2NiNzljYSJ9&amp;cAnyet74l9hdUag34h2dZu8z7gU=
</code></pre>
<blockquote>
<p>注：在分块上传数据和合并文件请求中，需要将此处所用『表单 API 验证密钥』替换为上次请求返回的 <code>token_secret</code>，再进行第四步计算</p>
</blockquote>
<p>第四步，将第三步所得字符计算 md5 后即得到 signature：</p>
<pre><code>98cf3f74698bfec04886eee446439ae3
</code></pre>
<hr />
<h2 id="_2">上传步骤<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>表单分块上传的整个步骤分为：</p>
<ol>
<li>初始化上传</li>
<li>分块上传数据</li>
<li>文件合并完成上传</li>
</ol>
<h3 id="_3">初始化上传<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<pre><code>POST /&lt;bucket-name&gt;/
</code></pre>
<h4 id="_4">请求类型<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<pre><code>Content-Type: application/x-www-form-urlencoded
</code></pre>
<h4 id="_5">请求参数<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必选</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>policy</td>
<td>string</td>
<td>true</td>
<td>文件存储/校验信息，见<a href="#signature">算法</a></td>
</tr>
<tr>
<td>signature</td>
<td>string</td>
<td>true</td>
<td>校验签名，见<a href="#policy">算法</a></td>
</tr>
</tbody>
</table>
<h4 id="_6">参数组<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>参数</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>文件存储路径</td>
</tr>
<tr>
<td>expiration</td>
<td>授权有效期，Unix UTC 时间戳</td>
</tr>
<tr>
<td>file_blocks</td>
<td>本次所上传的文件的分块数目</td>
</tr>
<tr>
<td>file_hash</td>
<td>所上传文件整个文件的 md5 hash 值</td>
</tr>
<tr>
<td>file_size</td>
<td>所上传文件整个文件的大小(单位 Byte)</td>
</tr>
</tbody>
</table>
<blockquote>
<p>注：请选取适当的 <code>file_blocks</code> 以保证分块的大小<strong> 不超过 5M </strong>，并且除最后一块外其余分块<strong> 不小于 100K </strong>。</p>
</blockquote>
<p>其他可选参数如下：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>可选性</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>allow-file-type</td>
<td>否</td>
<td>文件类型限制，制定允许上传的文件扩展名</td>
</tr>
<tr>
<td>content-length-range</td>
<td>否</td>
<td>文件大小限制，格式：<code>min,max</code>，单位：字节，如 <code>102400,1024000</code>，允许上传 100Kb～1Mb 的文件</td>
</tr>
<tr>
<td>content-md5</td>
<td>否</td>
<td>所上传的文件的 MD5 校验值，又拍云根据此来校验文件上传是否正确</td>
</tr>
<tr>
<td>content-secret</td>
<td>否</td>
<td>原图访问密钥 <a href="/api/form_api/#note2">[表单 API 注 2]</a></td>
</tr>
<tr>
<td>content-type</td>
<td>否</td>
<td>又拍云默认根据扩展名判断，手动指定可提高精确性</td>
</tr>
<tr>
<td>image-width-range</td>
<td>否</td>
<td>图片宽度限制，格式：<code>min,max</code>，单位：像素，如 <code>0,1024</code>，允许上传宽度为 0～1024px 之间</td>
</tr>
<tr>
<td>image-height-range</td>
<td>否</td>
<td>图片高度限制，格式：<code>min,max</code>，单位：像素，如 <code>0,1024</code>，允许上传高度在 0～1024px 之间</td>
</tr>
<tr>
<td>notify-url</td>
<td>否</td>
<td>异步通知 URL，见 <a href="/api/form_api/#notify_return">[表单 API 通知规则]</a></td>
</tr>
<tr>
<td>return-url</td>
<td>否</td>
<td>同步通知 URL，见 <a href="/api/form_api/#notify_return">[表单 API 通知规则]</a></td>
</tr>
<tr>
<td>x-gmkerl-thumb</td>
<td>否</td>
<td>图片处理参数，见 <a href="/cloud/image/#_2">上传作图</a></td>
</tr>
<tr>
<td>x-gmkerl-type</td>
<td>否</td>
<td><code>get_meta</code>（获取图片信息）或 <code>get_theme_color</code>（主题色提取）</td>
</tr>
<tr>
<td>x-gmkerl-extract-color-count</td>
<td>否</td>
<td>主题色提取颜色数量，默认 <code>256</code></td>
</tr>
<tr>
<td>x-gmkerl-extract-format</td>
<td>否</td>
<td>主题色提取格式，默认 <code>hex</code></td>
</tr>
<tr>
<td>ext-param</td>
<td>否</td>
<td>额外参数，UTF-8 编码，并小于 255 个字符 <a href="/api/form_api/#note5">[表单 API 注 5]</a></td>
</tr>
<tr>
<td>apps</td>
<td>否</td>
<td>json 格式的异步处理任务列表。见 <a href="/api/form_api/#_4">异步处理任务</a></td>
</tr>
<tr>
<td><em>x-gmkerl-thumbnail</em> <strong>DEPRECATED</strong></td>
<td><em>否</em></td>
<td><em>缩略图版本名称，仅支持图片类空间，可搭配其他 <code>x-gmkerl-*</code> 参数使用 <a href="/api/form_api/#note3">[表单 API 注 3]</a></em></td>
</tr>
<tr>
<td><em>x-gmkerl-type</em>  <strong>DEPRECATED</strong></td>
<td><em>否</em></td>
<td><em>缩略类型 <a href="/api/form_api/#note4">[表单 API 注 4]</a></em></td>
</tr>
<tr>
<td><em>x-gmkerl-value</em>  <strong>DEPRECATED</strong></td>
<td><em>否</em></td>
<td><em>缩略类型对应的参数值 <a href="/api/form_api/#note5">[表单 API 注 4]</a></em></td>
</tr>
<tr>
<td><em>x-gmkerl-quality</em>  <strong>DEPRECATED</strong></td>
<td><em>否</em></td>
<td><em><strong>默认 95</strong>缩略图压缩质量</em></td>
</tr>
<tr>
<td><em>x-gmkerl-unsharp</em>   <strong>DEPRECATED</strong></td>
<td><em>否</em></td>
<td><em><strong>默认锐化（true）</strong>是否进行锐化处理</em></td>
</tr>
<tr>
<td><em>x-gmkerl-rotate</em>  <strong>DEPRECATED</strong></td>
<td><em>否</em></td>
<td><em>图片旋转（顺时针），可选：<code>auto，90，180，270</code> 之一</em></td>
</tr>
<tr>
<td><em>x-gmkerl-crop</em>  <strong>DEPRECATED</strong></td>
<td><em>否</em></td>
<td><em>图片裁剪，格式：<code>&lt;w&gt;x&lt;h&gt;a&lt;x&gt;a&lt;y&gt;</code>。 其中 w, h 分别表示裁剪后的宽和高，x, y 表示左上角坐标。如 100x100a0a0。</em></td>
</tr>
<tr>
<td><em>x-gmkerl-exif-switch</em> <strong>DEPRECATED</strong></td>
<td><em>否</em></td>
<td><em>是否保留 EXIF 信息，仅在搭配 <code>x-gmkerl-crop，x-gmkerl-type，x-gmkerl-thumbnail</code> 时有效。</em></td>
</tr>
</tbody>
</table>
<h4 id="_7">返回结果<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<pre><code class="language-js">{
  save_token: '68640c7ab4120b4992907cabc6ea2c48',
  token_secret: &quot;89a3d8d8a26a8adb32a3651a63c0d5cc&quot;,
  bucket_name: 'example',
  blocks: 5,
  status: [0,0,0,0,0],
  expired_at: 1401784219
}
</code></pre>
<p><strong>返回参数说明</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>save_token</td>
<td>分块上传索引 key，下一步分块上传数据时必须携带本参数</td>
</tr>
<tr>
<td>token_secret</td>
<td>用于之后请求计算 <code>policy</code> 和 <code>signature</code> 所用，代替『表单 API 验证密钥』</td>
</tr>
<tr>
<td>bucket_name</td>
<td>文件保存空间</td>
</tr>
<tr>
<td>blocks</td>
<td>文件分块数量</td>
</tr>
<tr>
<td>status</td>
<td>分块文件上传状态，<code>1</code>表示已完成上传，<code>0</code>表示分块未完成上传。数组索引表示分块序号，<strong> 从 0 开始 </strong>；</td>
</tr>
<tr>
<td>expired_at</td>
<td>当前分块上传数据有效期，超过有效期之后数据将会被清理</td>
</tr>
</tbody>
</table>
<h3 id="_8">分块上传数据<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<pre><code>POST /&lt;bucket-name&gt;/
</code></pre>
<h4 id="_9">请求类型<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<pre><code>Content-Type: multipart/form-data
</code></pre>
<h4 id="_10">请求参数<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必选</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>policy</td>
<td>String</td>
<td>true</td>
<td>文件存储/校验信息，见<a href="#policy">算法</a></td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>true</td>
<td>校验签名，见<a href="#signature">算法</a></td>
</tr>
<tr>
<td>file</td>
<td>Blob</td>
<td>true</td>
<td>上传的文件分块数据</td>
</tr>
</tbody>
</table>
<h4 id="_11">参数组<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>参数</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>save_token</td>
<td>即初始化上传请求返回结果中的 <code>save_token</code></td>
</tr>
<tr>
<td>expiration</td>
<td>Unix UTC 时间戳，授权有效期，超过这个时间之后授权将会失效</td>
</tr>
<tr>
<td>block_index</td>
<td>该分块在完整文件中的分块索引</td>
</tr>
<tr>
<td>block_hash</td>
<td>该分块文件的 md5 值</td>
</tr>
</tbody>
</table>
<h4 id="_12">返回结果<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h4>
<p>上传成功返回:</p>
<pre><code>{
  save_token: '68640c7ab4120b4992907cabc6ea2c48',
  token_secret: &quot;89a3d8d8a26a8adb32a3651a63c0d5cc&quot;,
  bucket_name: 'example',
  blocks: 5,
  status: [1,1,1,1,0],
  expired_at: 1401784219
}
</code></pre>
<p><strong>返回参数说明</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>save_token</td>
<td>分块上传索引 key，下一步分块上传数据时必须携带本参数</td>
</tr>
<tr>
<td>token_secret</td>
<td>用于之后请求计算 <code>policy</code> 和 <code>signature</code> 所用，代替『表单 API 验证密钥』</td>
</tr>
<tr>
<td>bucket_name</td>
<td>文件保存空间</td>
</tr>
<tr>
<td>blocks</td>
<td>文件分块数量</td>
</tr>
<tr>
<td>status</td>
<td>分块文件上传状态，<code>1</code>表示已完成上传，<code>0</code>表示分块未完成上传。数组索引表示分块序号，<strong> 从 0 开始 </strong>；</td>
</tr>
<tr>
<td>expired_at</td>
<td>当前分块上传数据有效期，超过有效期之后数据将会被清理</td>
</tr>
</tbody>
</table>
<h3 id="_13">文件合并完成上传<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<pre><code>POST /&lt;bucket-name&gt;/
</code></pre>
<h4 id="_14">请求类型<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<pre><code>Content-Type: application/x-www-form-urlencoded
</code></pre>
<h4 id="_15">请求参数<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必选</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>policy</td>
<td>string</td>
<td>true</td>
<td>文件存储/校验信息，见<a href="#policy">算法</a></td>
</tr>
<tr>
<td>signature</td>
<td>string</td>
<td>true</td>
<td>校验签名，见<a href="#signature">算法</a></td>
</tr>
</tbody>
</table>
<h4 id="_16">参数组<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>参数</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>save_token</td>
<td>即初始化上传请求返回结果中的 <code>save_token</code></td>
</tr>
<tr>
<td>expiration</td>
<td>Unix UTC 时间戳，授权有效期，超过这个时间之后授权将会失效</td>
</tr>
</tbody>
</table>
<h4 id="_17">返回结果<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h4>
<p>表单 API 结合 <code>return-url</code> 和 <code>notify-url</code> 两个，有三种方式将上传结果返回:
* HTTP Body 同步返回；在没有传递 <code>return-url</code> 时，都会使用这种方式以 JSON 字符串的方式返回数据到客户端；
* 客户端同步跳转回调；传递 <code>return-url</code> 参数时，会通过 HTTP 302 的方式在客户端跳转到回调地址，通过 GET 参数传递；
* 服务器异步队列通知；传递了 <code>notify-url</code> 参数时，会通过又拍云的服务端异步队列发送 POST 请求以标准的<em>x-www-form-urlencoded</em>表单进行通知，如果回调通知失败，再重试 10 次（累计一天时间）之后将丢弃这条回调任务；</p>
<p>三种方式将返回/提交一样的数据，签名验证机制也完全一样，以 HTTP Body 返回的数据为例上传成功返回：</p>
<pre><code class="language-js">{
  bucket_name: 'example',
  path: '/demo.png',
  mimetype: 'image/png',
  file_size: 65422,
  image_width: 800,
  image_height: 600,
  image_frames: 1,
  image_type: 'PNG',
  last_modified: 1402021925,
  signature: 'c0ec4d6b0bb0515b4b889a12436118aa'
}
</code></pre>
<p><strong>返回参数说明</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>bucket_name</td>
<td>空间名</td>
</tr>
<tr>
<td>path</td>
<td>文件保存路径</td>
</tr>
<tr>
<td>mimetype</td>
<td>保存文件的 content-type</td>
</tr>
<tr>
<td>file_size</td>
<td>文件大小</td>
</tr>
<tr>
<td>image_width</td>
<td>图片宽度，仅图片返回</td>
</tr>
<tr>
<td>image_height</td>
<td>图片高度，仅图片返回</td>
</tr>
<tr>
<td>image_frames</td>
<td>图片帧数，仅图片返回</td>
</tr>
<tr>
<td>image_type</td>
<td>图片类型，仅图片返回</td>
</tr>
<tr>
<td>last_modified</td>
<td>文件最后修改时间，既本次上传操作成功创建文件的时间</td>
</tr>
<tr>
<td>signature</td>
<td>校验签名，用于校验返回数据的合法性 ，生成方式参见签名算法</td>
</tr>
<tr>
<td>ext-param</td>
<td>初始化时指定的额外参数（如果没有指定则不返回这个字段）</td>
</tr>
</tbody>
</table>
<p>同步回调方式会通过 HTTP 302 的方式进行跳转：</p>
<pre><code>&gt; Access-Control-Allow-Methods:PUT,POST
&gt; Access-Control-Allow-Origin:*
&gt; X-Powered-By:Crocodile/0.0.1
&gt; ...
&gt; Location: http://www.example.com/callback/return.php?path=%2Fdemo.png&amp;content_type=image%2Fpng&amp;file_size=65422&amp;image_width=800&amp;image_height=600&amp;image_frames=1&amp;last_modified=1402021925&amp;signature=bc0b1ee186486c050146616a6ec74747
</code></pre>
<h3 id="_18">错误代码说明<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>请参考 <a href="/api/errno/">API 错误码表</a></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2017, 又拍云
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>